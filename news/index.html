<!DOCTYPE html>
<html>

<head>
    <title>News API</title>
    <style>
        #card-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .card {
            border: 1px solid black;
            border-radius: 5px;
            box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.3);
            margin: 10px;
            padding: 10px;
            width: 300px;
        }

        .card h2 {
            font-size: 1.5rem;
            margin: 0;
            padding: 0;
        }

        .card p {
            font-size: 1rem;
            margin: 10px 0;
        }

        .show-more {
            cursor: pointer;
            color: blue;
        }

        table {
            border-collapse: collapse;
            margin: 20px auto;
            font-size: 1.2rem;
        }

        th,
        td {
            padding: 10px;
            border: 1px solid black;
            text-align: center;
        }

        th {
            background-color: #eee;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div id="card-container"></div>
    <table id="crypto-table"></table>
    <script>
        async function main() {
            async function getNews() {
                const response = await fetch(
                    "https://min-api.cryptocompare.com/data/v2/news/?lang=EN"
                );
                const data = await response.json();
                return data.Data;
            }

            async function createCard(article) {
                const card = document.createElement("div");
                card.classList.add("card");

                const title = document.createElement("h2");
                title.innerText = article.title;
                card.appendChild(title);

                const summary = document.createElement("p");
                summary.innerText = article.body.substring(0, 200) + "...";
                card.appendChild(summary);

                const showMore = document.createElement("span");
                showMore.innerText = "Show more";
                showMore.classList.add("show-more");
                showMore.addEventListener("click", () => {
                    summary.innerText = article.body;
                    showMore.style.display = "none";
                    showLess.style.display = "inline";
                });
                card.appendChild(showMore);

                const showLess = document.createElement("span");
                showLess.innerText = "Show less";
                showLess.classList.add("show-more");
                showLess.style.display = "none";
                showLess.addEventListener("click", () => {
                    summary.innerText = article.body.substring(0, 200) + "...";
                    showMore.style.display = "inline";
                    showLess.style.display = "none";
                });
                card.appendChild(showLess);

                return card;
            }

            async function renderCards() {
                const articles = await getNews();
                const cardContainer = document.getElementById("card-container");

                for (let article of articles) {
                    const card = await createCard(article);
                    cardContainer.appendChild(card);
                }
            }

            async function getCryptoPrices() {
                const response = await fetch(
                    "https://min-api.cryptocompare.com/data/pricemultifull?fsyms=BTC,ETH,USDT,BNB,USDC,XRP,ADA,DOGE,MATIC,SOL,DOT,LTC,SHIB,TRX,AVAX&tsyms=USDT"
                );
                const data = await response.json();

                return data.RAW;
            }

            function createCryptoTable(prices) {
                const table = document.getElementById("crypto-table");

                // Create table header
                const headerRow = document.createElement("tr");
                const nameHeader = document.createElement("th");
                nameHeader.innerText = "Name";
                headerRow.appendChild(nameHeader);
                const priceHeader = document.createElement("th");
                priceHeader.innerText = "Price (USDT)";
                headerRow.appendChild(priceHeader);
                const changeHeader = document.createElement("th");
                changeHeader.innerText = "24h Change (%)";
                headerRow.appendChild(changeHeader);
                const imageHeader = document.createElement("th");
                imageHeader.innerText = "Image";
                headerRow.appendChild(imageHeader);
                const marketHeader = document.createElement("th");
                marketHeader.innerText = "Last Market";
                headerRow.appendChild(marketHeader);
                table.appendChild(headerRow);

                // Create table body
                for (let [symbol, data] of Object.entries(prices)) {
                    const name = data.USDT.FROMSYMBOL;
                    const price = data.USDT.PRICE.toFixed(2);
                    const change = data.USDT.CHANGEPCT24HOUR.toFixed(2);
                    const imageUrl = `https://cryptocompare.com/${data.USDT.IMAGEURL}`;
                    const lastMarket = data.USDT.LASTMARKET;

                    const row = document.createElement("tr");
                    const nameCell = document.createElement("td");
                    nameCell.innerText = name;
                    row.appendChild(nameCell);
                    const priceCell = document.createElement("td");
                    priceCell.innerText = price;
                    row.appendChild(priceCell);
                    const changeCell = document.createElement("td");
                    changeCell.innerText = change;
                    row.appendChild(changeCell);
                    const imageCell = document.createElement("td");
                    const image = document.createElement("img");
                    image.src = imageUrl;
                    imageCell.appendChild(image);
                    row.appendChild(imageCell);
                    const marketCell = document.createElement("td");
                    marketCell.innerText = lastMarket;
                    row.appendChild(marketCell);
                    table.appendChild(row);
                }
            }


            await renderCards();
            const prices = await getCryptoPrices();
            createCryptoTable(prices);
        }
        main();

    </script>
</body>

</html>